<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=gb2312" />
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
    <title>Bus Station</title>
</head>

<body>
  <div id="busstation">bus station data should be here</div>


  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
  <script src="jquery-2.2.0.js"></script>
  <script type="text/javascript">
  lat1 = 23.017212;
  lon1 = 113.162134;
  lat2 = 23.347828;
  lon2 = 113.627241;
  las = 0.1;
  key = '6d36b554c5f27c3118007b83b5a68b44'
  var station = [];

  latCount = Math.ceil((lat2-lat1)/las+1);
  lonCount = Math.ceil((lon2-lon1)/las+1);
  console.log(lonCount + ',' + latCount);
  url = 'http://restapi.amap.com/v3/place/text?keywords=公交车站&city=广州&offset=25&page=1&key=6d36b554c5f27c3118007b83b5a68b44'

  for (page = 0; page < 100; page++) {
    url = 'http://restapi.amap.com/v3/place/text?keywords=公交车站&city=广州&offset=25&page=' + page + '&key=6d36b554c5f27c3118007b83b5a68b44'
    $.ajax(url).then(function(data){
      for (i = 0; i <25; i++) {
        item = JSON.stringify(data.pois[i]);
        console.log(data.pois[i]);
        $("#busstation").append(item + ',');
      }
    })
  }

  console.log(station);
  </script>

</body>
</html>
